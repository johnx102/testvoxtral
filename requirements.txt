# =============================================================================
# REQUIREMENTS.TXT - Versions testées et compatibles entre elles
# Dernière mise à jour: 2026-01-13
# =============================================================================

# -----------------------------------------------------------------------------
# PYTORCH - Versions IDENTIQUES au Dockerfile (éviter conflits)
# PyTorch 2.8.0 requis pour pyannote 4.x + support TOUS les GPUs
# IMPORTANT: Ces versions doivent correspondre au Dockerfile!
# -----------------------------------------------------------------------------
--extra-index-url https://download.pytorch.org/whl/cu128
torch==2.8.0
torchaudio==2.8.0
torchvision==0.23.0

# -----------------------------------------------------------------------------
# TRANSFORMERS + ACCELERATE (versions compatibles entre elles)
# Voxtral support ajouté en transformers 4.54.0
# -----------------------------------------------------------------------------
transformers>=4.54.0,<4.58.0
accelerate>=1.0.0,<2.0.0
huggingface_hub>=0.24.0,<1.0

# -----------------------------------------------------------------------------
# PYANNOTE - Speaker diarization
# Version 4.x = compatible PyTorch 2.6+ (fix weights_only)
# -----------------------------------------------------------------------------
pyannote.audio>=4.0.0
lightning>=2.0.1,<3.0.0

# -----------------------------------------------------------------------------
# MISTRAL / VOXTRAL - Audio transcription
# mistral_common[audio] nécessite Python >= 3.10
# -----------------------------------------------------------------------------
mistral_common[audio]>=1.8.1,<2.0.0
sentencepiece>=0.2.0

# -----------------------------------------------------------------------------
# AUDIO PROCESSING
# Note: librosa est installé automatiquement par pyannote avec versions compatibles
# -----------------------------------------------------------------------------
soundfile>=0.12.1
pydub>=0.25.1

# -----------------------------------------------------------------------------
# NUMPY/SCIPY - Laisser pyannote gérer les versions compatibles
# -----------------------------------------------------------------------------
numpy<2.0.0

# -----------------------------------------------------------------------------
# AUTRES DÉPENDANCES
# -----------------------------------------------------------------------------
requests>=2.32.0
safetensors>=0.4.0
einops>=0.6.0

# -----------------------------------------------------------------------------
# RUNPOD
# -----------------------------------------------------------------------------
runpod>=1.6.0,<2.0.0

# -----------------------------------------------------------------------------
# OPTIONNEL - WhisperX (décommenter si nécessaire)
# Alternative à Voxtral pour éviter les bugs de répétition
# -----------------------------------------------------------------------------
# git+https://github.com/m-bain/whisperX.git
